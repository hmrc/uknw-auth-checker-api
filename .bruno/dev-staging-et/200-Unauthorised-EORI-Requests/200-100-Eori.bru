meta {
  name: 200-100-Eori
  type: http
  seq: 3
}

post {
  url: {{apiEndpoint}}
  body: json
  auth: none
}

headers {
  Accept: application/vnd.hmrc.1.0+json
  Authorization: Bearer {{bearerToken}}
}

body:json {
  {
    "eoris": [
      "GB702601139907",
      "GB305827433009",
      "XI569274482382127",
      "GB823797040419",
      "XI777849853217",
      "XI789846947365",
      "XI357011494986629",
      "XI285454673506",
      "XI149016980551455",
      "GB589381027655060",
      "XI534690280150221",
      "XI963665493735",
      "XI766572079641",
      "XI714597793184457",
      "GB318054272651147",
      "XI130561030969374",
      "GB990892213020",
      "XI426102349182750",
      "GB099014188833242",
      "XI210109511599",
      "XI949349657288",
      "XI926752024124646",
      "GB472291417642058",
      "GB961112249357970",
      "GB013815307229014",
      "GB119090292186571",
      "XI485592408260",
      "XI139461969956652",
      "XI027866128444",
      "GB492437168703",
      "GB518282641708942",
      "XI851112158184591",
      "XI615922278770",
      "XI529180388935",
      "GB964121845023",
      "XI897573598830",
      "GB640796601169",
      "GB412268634455497",
      "GB227854148633974",
      "XI388579403332",
      "XI304737971537001",
      "GB525935765740759",
      "GB217351719036",
      "XI927756160611736",
      "GB142936755510",
      "XI216356781173",
      "XI824385048554333",
      "XI966845275249487",
      "GB139476006748061",
      "GB442911889564",
      "XI966855200250",
      "GB753144116188",
      "XI360338185129961",
      "GB864905813165838",
      "GB262689444343549",
      "GB905775090723",
      "GB692130757988",
      "GB673401594735",
      "XI140588991474008",
      "XI654762232604865",
      "XI013286079091",
      "XI848155764992820",
      "GB599599627874601",
      "GB154847153127",
      "XI704179883989",
      "GB919901537854389",
      "GB761316704269769",
      "GB390058840638329",
      "XI460045890798",
      "GB231805364245257",
      "XI965151551335",
      "GB859513682229641",
      "GB237315157551343",
      "GB685479722525978",
      "XI819250777082",
      "GB277936072687",
      "XI213044636764",
      "GB887938361354",
      "XI001963248381058",
      "XI256891169061",
      "XI943617806417",
      "GB418750880069",
      "XI324690244130",
      "GB660922115340",
      "GB592226641435201",
      "XI556818173216941",
      "GB051768011273",
      "XI079091132165035",
      "XI584726435472642",
      "GB784957996903",
      "XI665909800549",
      "XI181364973040",
      "GB531780269523527",
      "GB563044905044",
      "GB333250878791829",
      "XI183828160767",
      "GB904482849489",
      "GB477026947245266",
      "XI389664001176",
      "XI906876713836868"
    ]
  }
}

tests {
  test("should have 100 EORI results", function() {
    const data = res.getBody();
    expect(res.getStatus()).to.equal(200);
    expect(data.eoris).to.be.an('array').that.has.lengthOf(100);
  });
  
  test("all EORI results should be unauthorised", function() {
    const data = res.getBody();
    data.eoris.map(json => expect(json.authorised).to.equal(false))
  });
    test("confirm Date Format", function() {
        const data = res.getBody();
    var timestampFormat= /^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{2}Z$/.test(data.date);
    expect(timestampFormat).to.equal(true);
    var currentDate =  new Date().toJSON().slice(0, 15);
      expect(data.date).to.startWith(currentDate);
    });
  }
}
